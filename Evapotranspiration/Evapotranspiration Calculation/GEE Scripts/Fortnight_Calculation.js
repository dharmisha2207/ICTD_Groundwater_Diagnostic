var shape = /*Any Featurecollection*/;


var fn=ee.ImageCollection.fromImages([
    image26,
    image25,
    image24,
    image23,
    image22,
    image21,
    image20,
    image19,
    image18,
    image17,
    image16,
    image15,
    image14,
    image13,
    image12,
    image11,
    image10,
    image9,
    image8,
    image7,
    image6,
    image5,
    image4,
    image3,
    image2,
    image1,
    image52,
    image51,
    image50,
    image49,
    image48,
    image47,
    image46,
    image45,
    image44,
    image43,
    image42,
    image41,
    image40,
    image39,
    image38,
    image37,
    image36,
    image35,
    image34,
    image33,
    image32,
    image31,
    image30,
    image29,
    image28,
    image27,
    image77,
    image76,
    image75,
    image74,
    image73,
    image72,
    image71,
    image70,
    image69,
    image68,
    image67,
    image66,
    image65,
    image64,
    image63,
    image62,
    image61,
    image60,
    image59,
    image58,
    image57,
    image56,
    image55,
    image54,
    image532,
    image53,
    image103,
    image102,
    image101,
    image100,
    image99,
    image98,
    image97,
    image96,
    image95,
    image94,
    image93,
    image92,
    image91,
    image90,
    image89,
    image88,
    image87,
    image86,
    image85,
    image84,
    image83,
    image82,
    image81,
    image80,
    image79,
    image78,
    image129,
    image128,
    image127,
    image126,
    image125,
    image124,
    image123,
    image122,
    image121,
    image120,
    image119,
    image118,
    image117,
    image116,
    image115,
    image114,
    image113,
    image112,
    image111,
    image110,
    image109,
    image108,
    image107,
    image106,
    image105,
    image104,
    image155,
    image154,
    image153,
    image152,
    image151,
    image150,
    image149,
    image148,
    image147,
    image146,
    image145,
    image144,
    image143,
    image142,
    image141,
    image140,
    image139,
    image138,
    image137,
    image136,
    image135,
    image134,
    image133,
    image132,
    image131,
    image130]);
    
    var start_dates = ee.List([
    '2017-01-01',
    '2017-01-15',
    '2017-01-29',
    '2017-02-12',
    '2017-02-26',
    '2017-03-12',
    '2017-03-26',
    '2017-04-09',
    '2017-04-23',
    '2017-05-07',
    '2017-05-21',
    '2017-06-04',
    '2017-06-18',
    '2017-07-02',
    '2017-07-16',
    '2017-07-30',
    '2017-08-13',
    '2017-08-27',
    '2017-09-10',
    '2017-09-24',
    '2017-10-08',
    '2017-10-22',
    '2017-11-05',
    '2017-11-19',
    '2017-12-03',
    '2017-12-17',
    '2018-01-01',
    '2018-01-15',
    '2018-01-29',
    '2018-02-12',
    '2018-02-26',
    '2018-03-12',
    '2018-03-26',
    '2018-04-09',
    '2018-04-23',
    '2018-05-07',
    '2018-05-21',
    '2018-06-04',
    '2018-06-18',
    '2018-07-02',
    '2018-07-16',
    '2018-07-30',
    '2018-08-13',
    '2018-08-27',
    '2018-09-10',
    '2018-09-24',
    '2018-10-08',
    '2018-10-22',
    '2018-11-05',
    '2018-11-19',
    '2018-12-03',
    '2018-12-17',
    '2019-01-01',
    '2019-01-15',
    '2019-01-29',
    '2019-02-12',
    '2019-02-26',
    '2019-03-12',
    '2019-03-26',
    '2019-04-09',
    '2019-04-23',
    '2019-05-07',
    '2019-05-21',
    '2019-06-04',
    '2019-06-18',
    '2019-07-02',
    '2019-07-16',
    '2019-07-30',
    '2019-08-13',
    '2019-08-27',
    '2019-09-10',
    '2019-09-24',
    '2019-10-08',
    '2019-10-22',
    '2019-11-05',
    '2019-11-19',
    '2019-12-03',
    '2019-12-17',
    '2020-01-01',
    '2020-01-15',
    '2020-01-29',
    '2020-02-12',
    '2020-02-26',
    '2020-03-11',
    '2020-03-25',
    '2020-04-08',
    '2020-04-22',
    '2020-05-06',
    '2020-05-20',
    '2020-06-03',
    '2020-06-17',
    '2020-07-01',
    '2020-07-15',
    '2020-07-29',
    '2020-08-12',
    '2020-08-26',
    '2020-09-09',
    '2020-09-23',
    '2020-10-07',
    '2020-10-21',
    '2020-11-04',
    '2020-11-18',
    '2020-12-02',
    '2020-12-16',
    '2021-01-01',
    '2021-01-15',
    '2021-01-29',
    '2021-02-12',
    '2021-02-26',
    '2021-03-12',
    '2021-03-26',
    '2021-04-09',
    '2021-04-23',
    '2021-05-07',
    '2021-05-21',
    '2021-06-04',
    '2021-06-18',
    '2021-07-02',
    '2021-07-16',
    '2021-07-30',
    '2021-08-13',
    '2021-08-27',
    '2021-09-10',
    '2021-09-24',
    '2021-10-08',
    '2021-10-22',
    '2021-11-05',
    '2021-11-19',
    '2021-12-03',
    '2021-12-17',
    '2022-01-01',
    '2022-01-15',
    '2022-01-29',
    '2022-02-12',
    '2022-02-26',
    '2022-03-12',
    '2022-03-26',
    '2022-04-09',
    '2022-04-23',
    '2022-05-07',
    '2022-05-21',
    '2022-06-04',
    '2022-06-18',
    '2022-07-02',
    '2022-07-16',
    '2022-07-30',
    '2022-08-13',
    '2022-08-27',
    '2022-09-10',
    '2022-09-24',
    '2022-10-08',
    '2022-10-22',
    '2022-11-05',
    '2022-11-19',
    '2022-12-03',
    '2022-12-17'
    ]);
    
    var end_dates = ee.List([
    '2017-01-14',
    '2017-01-28',
    '2017-02-11',
    '2017-02-25',
    '2017-03-11',
    '2017-03-25',
    '2017-04-08',
    '2017-04-22',
    '2017-05-06',
    '2017-05-20',
    '2017-06-03',
    '2017-06-17',
    '2017-07-01',
    '2017-07-15', 
    '2017-07-29',
    '2017-08-12',
    '2017-08-26',
    '2017-09-09',
    '2017-09-23',
    '2017-10-07',
    '2017-10-21',
    '2017-11-04',
    '2017-11-18',
    '2017-12-02',
    '2017-12-16',
    '2017-12-30',
    '2018-01-14',
    '2018-01-28',
    '2018-02-11',
    '2018-02-25',
    '2018-03-11',
    '2018-03-25',
    '2018-04-08',
    '2018-04-22',
    '2018-05-06',
    '2018-05-20',
    '2018-06-03',
    '2018-06-17',
    '2018-07-01',
    '2018-07-15',
    '2018-07-29',
    '2018-08-12',
    '2018-08-26',
    '2018-09-09',
    '2018-09-23',
    '2018-10-07',
    '2018-10-21',
    '2018-11-04',
    '2018-11-18',
    '2018-12-02',
    '2018-12-16',
    '2018-12-30',
    '2019-01-14',
    '2019-01-28',
    '2019-02-11',
    '2019-02-25',
    '2019-03-11',
    '2019-03-25',
    '2019-04-08',
    '2019-04-22',
    '2019-05-06',
    '2019-05-20',
    '2019-06-03',
    '2019-06-17',
    '2019-07-01',
    '2019-07-15',
    '2019-07-29',
    '2019-08-12',
    '2019-08-26',
    '2019-09-09',
    '2019-09-23',
    '2019-10-07',
    '2019-10-21',
    '2019-11-04',
    '2019-11-18',
    '2019-12-02',
    '2019-12-16',
    '2019-12-30',
    '2020-01-14',
    '2020-01-28',
    '2020-02-11',
    '2020-02-25',
    '2020-03-10',
    '2020-03-24',
    '2020-04-07',
    '2020-04-21',
    '2020-05-05',
    '2020-05-19',
    '2020-06-02',
    '2020-06-16',
    '2020-06-30',
    '2020-07-14',
    '2020-07-28',
    '2020-08-11',
    '2020-08-25',
    '2020-09-08',
    '2020-09-22',
    '2020-10-06',
    '2020-10-20',
    '2020-11-03',
    '2020-11-17',
    '2020-12-01',
    '2020-12-15',
    '2020-12-29',
    '2021-01-14',
    '2021-01-28',
    '2021-02-11',
    '2021-02-25',
    '2021-03-11',
    '2021-03-25',
    '2021-04-08',
    '2021-04-22',
    '2021-05-06',
    '2021-05-20',
    '2021-06-03',
    '2021-06-17',
    '2021-07-01',
    '2021-07-15',
    '2021-07-29',
    '2021-08-12',
    '2021-08-26',
    '2021-09-09',
    '2021-09-23',
    '2021-10-07',
    '2021-10-21',
    '2021-11-04',
    '2021-11-18',
    '2021-12-02',
    '2021-12-16',
    '2021-12-30',
    '2022-01-14',
    '2022-01-28',
    '2022-02-11',
    '2022-02-25',
    '2022-03-11',
    '2022-03-25',
    '2022-04-08',
    '2022-04-22',
    '2022-05-06',
    '2022-05-20',
    '2022-06-03',
    '2022-06-17',
    '2022-07-01',
    '2022-07-15',
    '2022-07-29',
    '2022-08-12',
    '2022-08-26',
    '2022-09-09',
    '2022-09-23',
    '2022-10-07',
    '2022-10-21',
    '2022-11-04',
    '2022-11-18',
    '2022-12-02',
    '2022-12-16',
    '2022-12-30'
    ]);
    
    
    var size = shape.size();
    var size1 = ee.Number(size).subtract(ee.Number(1));
    
    fn = ee.List(fn.toList(156));
    
    for(var n = 0;n<156;n++)
    {
      var total = ee.Image(fn.get(n));
      var mws = ee.List.sequence(0,size1);
      total = total.select('b1');
      
    // Total pixels
      var pixelCount = total.reduceRegions({
        reducer: ee.Reducer.count(),
        collection: shape,
        scale: 1113.1949079327357
      });
      pixelCount = pixelCount.toList(size);
      // Total Negative Pixels
      var negativePixels = total.lt(0); // 'lt' stands for less than (<) operator
      
      var negativePixelCount = negativePixels.reduceRegions({
        reducer: ee.Reducer.sum(),
        collection: shape,
        scale: 1113.1949079327357
      });
      
      var ll = function(k)
      {
        var pc = ee.Feature(pixelCount.get(k));
        var id = pc.get('uid');
        var nc = negativePixelCount.filter(ee.Filter.eq('uid', id)).first();
        var p = ee.Number(pc.get('count'));
        nc = ee.Number(nc.get('sum'));
        var val = p.subtract(nc);
        return pc.set('tot',val);
      }
      
      var totalpix = ee.FeatureCollection(mws.map(ll));
      
      total = total.expression(
                'ET>0?86400*ET:0', {
                  'ET': total.select('b1')
            });
    // =======================================================================
      var stats2 = total.reduceRegions({
        reducer: ee.Reducer.sum(),
        collection: shape,
        scale: 1113.1949079327357,
      });
      
      var statsl = stats2.toList(size);
      var e = end_dates.get(n);
      var res = function(m){
        var f = ee.Feature(statsl.get(m));
        var s = ee.Number(f.get('sum'));
        var id = f.get('uid');
        var feat = shape.filter(ee.Filter.eq('uid', id)).first();
        var pix = totalpix.filter(ee.Filter.eq('uid', id)).first();
        pix = ee.Number(pix.get('tot'));
        var val = s.divide(pix);
        return feat.set(e, val);
      };
      shape = ee.FeatureCollection(mws.map(res));
    }
    
    
    Export.table.toAsset({
      collection: shape,
      description: 'ET',
      assetId: 'projects/ee-dharmisha-siddharth/assets/Fortnight_ET_Pindwara'
    });